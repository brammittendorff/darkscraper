{
  "uid": "darkscraper-network-analysis",
  "title": "Network Analysis",
  "timezone": "browser",
  "schemaVersion": 39,
  "version": 1,
  "refresh": "1m",
  "links": [
    {"title": "Overview", "url": "/d/darkscraper-overview", "type": "link"},
    {"title": "Monitor", "url": "/d/darkscraper-monitor", "type": "link"}
  ],
  "panels": [
    {"id": 1, "title": "Most Linked-To Domains (All Networks)", "type": "table", "gridPos": {"h": 12, "w": 12, "x": 0, "y": 0}, "datasource": {"type": "grafana-postgresql-datasource", "uid": "darkscraper-pg"}, "targets": [{"rawSql": "SELECT l.target_url, COUNT(*) as inbound_links, COUNT(DISTINCT l.source_page_id) as linking_pages, CASE WHEN l.is_onion THEN 'tor' WHEN l.is_i2p THEN 'i2p' WHEN l.is_hyphanet THEN 'hyphanet' WHEN l.is_lokinet THEN 'lokinet' END as network FROM links l GROUP BY l.target_url, network ORDER BY inbound_links DESC LIMIT 100;", "format": "table", "refId": "A"}], "options": {"showHeader": true}},

    {"id": 2, "title": "Cross-Network Links", "type": "table", "gridPos": {"h": 12, "w": 12, "x": 12, "y": 0}, "datasource": {"type": "grafana-postgresql-datasource", "uid": "darkscraper-pg"}, "targets": [{"rawSql": "SELECT p.network as source_network, CASE WHEN l.is_onion THEN 'tor' WHEN l.is_i2p THEN 'i2p' WHEN l.is_hyphanet THEN 'hyphanet' WHEN l.is_lokinet THEN 'lokinet' END as target_network, COUNT(*) as links FROM links l JOIN pages p ON l.source_page_id = p.id WHERE p.network != CASE WHEN l.is_onion THEN 'tor' WHEN l.is_i2p THEN 'i2p' WHEN l.is_hyphanet THEN 'hyphanet' WHEN l.is_lokinet THEN 'lokinet' END GROUP BY source_network, target_network ORDER BY links DESC;", "format": "table", "refId": "A"}], "options": {"showHeader": true}},

    {"id": 3, "title": "Top Linking Domains (Outbound)", "type": "table", "gridPos": {"h": 10, "w": 12, "x": 0, "y": 12}, "datasource": {"type": "grafana-postgresql-datasource", "uid": "darkscraper-pg"}, "targets": [{"rawSql": "SELECT p.network, p.domain, COUNT(l.id) as outbound_links, COUNT(DISTINCT l.target_url) as unique_targets FROM pages p JOIN links l ON p.id = l.source_page_id GROUP BY p.network, p.domain ORDER BY outbound_links DESC LIMIT 50;", "format": "table", "refId": "A"}], "options": {"showHeader": true}},

    {"id": 4, "title": "Link Distribution by Network", "type": "barchart", "gridPos": {"h": 10, "w": 12, "x": 12, "y": 12}, "datasource": {"type": "grafana-postgresql-datasource", "uid": "darkscraper-pg"}, "targets": [{"rawSql": "SELECT p.network, COUNT(l.id) AS links FROM links l JOIN pages p ON l.source_page_id = p.id GROUP BY p.network ORDER BY links DESC;", "format": "table", "refId": "A"}], "fieldConfig": {"defaults": {}, "overrides": []}, "options": {"orientation": "horizontal"}},

    {"id": 5, "title": "Domain Interconnections", "type": "table", "gridPos": {"h": 12, "w": 24, "x": 0, "y": 22}, "datasource": {"type": "grafana-postgresql-datasource", "uid": "darkscraper-pg"}, "targets": [{"rawSql": "SELECT p1.domain as source_domain, p1.network as source_net, regexp_replace(l.target_url, 'https?://([^/]+).*', '\\1') as target_domain, CASE WHEN l.is_onion THEN 'tor' WHEN l.is_i2p THEN 'i2p' WHEN l.is_hyphanet THEN 'hyphanet' WHEN l.is_lokinet THEN 'lokinet' END as target_net, COUNT(*) as links FROM links l JOIN pages p1 ON l.source_page_id = p1.id WHERE p1.domain != regexp_replace(l.target_url, 'https?://([^/]+).*', '\\1') GROUP BY source_domain, source_net, target_domain, target_net ORDER BY links DESC LIMIT 100;", "format": "table", "refId": "A"}], "options": {"showHeader": true}}
  ]
}
